# Submission Configuration for Payment Gateway
# This file is used for automated evaluation

name: payment-gateway-deliverable-2
version: "1.0.0"
description: "Payment Gateway with async processing, webhooks, SDK, and refunds"

# Setup commands
setup:
  - name: "Create Docker network"
    command: "docker network create gateway-network 2>/dev/null || true"
  
# Start commands
start:
  - name: "Start all services with Docker Compose"
    command: "docker-compose up -d --build"
  - name: "Wait for services to be healthy"
    command: "sleep 30"

# Test commands
test:
  - name: "Health check - API"
    command: "curl -f http://localhost:8000/health"
  - name: "Health check - Dashboard"
    command: "curl -f http://localhost:3000"
  - name: "Health check - Checkout"
    command: "curl -f http://localhost:3001/health"
  - name: "Job queue status check"
    command: "curl -f http://localhost:8000/api/v1/test/jobs/status"

# Verify commands
verify:
  - name: "Verify API endpoints"
    command: |
      curl -X POST http://localhost:8000/api/v1/orders \
        -H "X-Api-Key: key_test_abc123" \
        -H "X-Api-Secret: secret_test_xyz789" \
        -H "Content-Type: application/json" \
        -d '{"amount": 50000, "currency": "INR", "receipt": "test_receipt"}'
  - name: "Verify Redis connection"
    command: "docker exec redis_gateway redis-cli ping"
  - name: "Verify worker is running"
    command: "docker logs gateway_worker --tail 5"

# Shutdown commands
shutdown:
  - name: "Stop all services"
    command: "docker-compose down"
  - name: "Remove volumes (optional)"
    command: "docker-compose down -v"

# Service endpoints
endpoints:
  api: "http://localhost:8000"
  dashboard: "http://localhost:3000"
  checkout: "http://localhost:3001"
  redis: "redis://localhost:6379"
  postgres: "postgresql://gateway_user:gateway_pass@localhost:5432/payment_gateway"

# Test credentials
credentials:
  api_key: "key_test_abc123"
  api_secret: "secret_test_xyz789"
  webhook_secret: "whsec_test_abc123"
  merchant_email: "test@example.com"

# Environment variables for test mode
test_environment:
  TEST_MODE: "true"
  TEST_PROCESSING_DELAY: "1000"
  TEST_PAYMENT_SUCCESS: "true"
  WEBHOOK_RETRY_INTERVALS_TEST: "true"
